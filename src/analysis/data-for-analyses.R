d <- d %>%
  mutate(D4 = recode(D4, 
                     `1` = "Big City",
                     `2` = "Suburb",
                     `3` = "Middlesized City",
                     `4` = "Rural Village",
                     `5` = "Countryside", .default = "NA"),
         D6 = recode(D6,
                     `1` = "CDU/CSU",
                     `2` = "SPD",
                     `3` = "AfD",
                     `4` = "Left",
                     `5` = "Greens",
                     `6` = "Other party", .default = "NA"),
        Afd_vote = if_else(D6 == "AfD", 1, 0),
        D7 = na_if(D7, 12),
        D8 = na_if(D8, 14),
        D9 = recode(D9,
                    `1` = "Baden-Würtemberg",
                    `17` = "Bavaria",
                    `18` = "Berlin",
                    `19` = "Brandenburg",
                    `20` = "Bremen",
                    `21` = "Hamburg",
                    `22` = "Hessen",
                    `23` = "Lower Saxony",
                    `24` = "Mecklenburg-Western Pomerania",
                    `25` = "North Rhine-Westphalia",
                    `26` = "Rhineland-Palatinate",
                    `27` = "Saarland",
                    `28` = "Saxony",
                    `29` = "Saxony-Anholt",
                    `30` = "Schleswig-Holstein",
                    `31` = "Thuringia",
                    .default = "NA"),
        D10 = recode(D10,
                    `1` = "Baden-Würtemberg",
                    `17` = "Bavaria",
                    `18` = "Berlin",
                    `19` = "Brandenburg",
                    `20` = "Bremen",
                    `21` = "Hamburg",
                    `22` = "Hessen",
                    `23` = "Lower Saxony",
                    `24` = "Mecklenburg-Western Pomerania",
                    `25` = "North Rhine-Westphalia",
                    `26` = "Rhineland-Palatinate",
                    `27` = "Saarland",
                    `28` = "Saxony",
                    `29` = "Saxony-Anholt",
                    `30` = "Schleswig-Holstein",
                    `31` = "Thuringia",
                    `32` = "Not born in Germany", .default = "NA"),
        HT4 = round((HT4_1 + HT4_2 + HT4_3 + HT4_4)/4, 0),
        HT4 = 6 - HT4,
        PT4 = if_else(PT4 == 3, 1, 0),
        PT5 = if_else(PT5 == 5, 1, 0),
        PT6 = if_else(PT6==1, 1, 0),
        pol_know = PT4 + PT5 + PT6,
        PT7 =  na_if(PT7, 7),
        ethnic = if_else(populism=="Volk", 1, 0),
        POST_1 = as_numeric(POST_1),
        POST_2 = as_numeric(POST_2),
        POST_3 = as_numeric(POST_3),
        POST_4 = as_numeric(POST_4),
        POST_5 = as_numeric(POST_5),
        POST_6 = as_numeric(POST_6)) %>%
  select(id, D4:D10, pol_know, PT7:PT8, HT4, Afd_vote, ethnic, POST_1:POST_6)
